function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 06-Apr-2018 19:47:01.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx83 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx1 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-13.6920149962324;-4.35261768937021;-16.3039815284249;-15.2790104832376;-16.3735559881618;-15.2089951143805;-2.92865772086456;-3.41468361681803;-6.76633494365131;-14.0932681107493;-14.6472116160684;-14.9380594510198;-3.20367913175734;-3.85368258969809;-6.60689534149885;-13.7551750632722;-13.9657143856787;-15.0885050472266;-3.83830750313779;-4.54036453571607;-6.40512037305591;-13.3036599494706;-13.3045707900478;-15.5969331185167;-5.19847022162521;-6.22833145243611;-6.57924401203602;-14.060683171576;-5.37373626093337;-5.09601716446513;-16.2368797118666;-18.4206807439524;-18.4206807439524;-18.4206807439524;-18.4206807439524;-18.4206807439524;-18.4206807439524;-5.55958997191979;-5.67528747749652;-16.3534259122669;-18.4206807439524;-18.4206807439524;-18.4206807439524;-4.3520337249107;-17.624476046706;-2.33983418332993;-5.55598577276104;-4.79255581149716;-4.05864313446522;-3.7160227759555;-3.40579177165893;-3.35606221386858;-3.30589171609725;3.91523237904218;-16.5358407575788;1.03636146490656;-0.0166991300325305;9.17399185013064;5.00935242035012;1.03136006522416;-0.0468100536127695;8.89491151866412;4.9666721707448;1.04091406728024;-0.157734844113559;8.81612783058653;4.90366317461828;1.03821658191923;-0.0907314216364858;8.66710551433142;4.80011020682355;0.958001224292115;-0.108655529573944;8.69529635474088;4.79744207371772;0.971987466213569;-0.13380290283035;8.66931976899383;4.75131901147472;0.92395360858919;-0.45361908941434;8.56504279796178;4.6923667311099];
x1_step1.gain = [0.26625290173239;0.630839631694426;0.313389718752211;0.295641127267659;0.294360142392352;0.298239074550575;0.527271673843592;0.553896053935281;0.4045771128529;0.197213427686911;0.267557442491466;0.278521895116541;1.36199228944814;1.23025775291652;0.46679395812819;0.216529494418005;0.284661050088941;0.26370227730484;0.854094059982323;0.821671657820577;0.472710470824211;0.222825861134697;0.295783634532321;0.241152623774995;0.503180120540771;0.465685810629967;0.41013771792385;0.199370146178264;0.356895337075989;0.336147862901831;0.325774443993076;0.104480023008977;0.102415211121119;0.205779889358465;0.0988583066719799;0.0993713237095071;0.208887719795046;0.490571639029869;0.395309982347315;0.37716491969429;0.10238205080245;0.10060395632236;0.205975636936167;0.630957192667552;0.13765343103543;0.29938257876203;1.00610995912092;0.925900339269642;0.981644853359215;1.00986242024161;1.09095498172615;1.00922925133195;1.12661021474619;1.19457367137168;0.336525367653198;0.930019769700038;0.525835189726627;0.790924566258799;1.52442939762929;0.94134184928035;0.546929256735221;0.774187439211187;1.60905049998933;0.902870896880092;0.514558810709724;0.749982445596847;1.5510550836047;0.880312363682692;0.528470428582049;0.738167569648247;1.4725699792678;0.795415610703719;0.570025011026192;0.755293220869951;1.49439239803427;0.799864808774728;0.568066042432634;0.781540762322857;1.48379791851195;0.79367907013336;0.48963618601293;0.750941148293752;1.42162099912729];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3539253928222898526;1.1571412969738830157;0.80917174937176905569;0.36799339230490135666;0.22903634059904623421;-0.1839817433148464576;0.70834737646374068554;0.66619022528213922563;-1.1712622711540667808;1.3572383105050134233];
IW1_1 = [0.22332324197757569273 -0.13461119827311970876 0.043879484179765747276 0.014715280443998703108 -0.15567244961817872095 0.033355249806090642162 -0.18777579100722749383 0.22680656927441106285 -0.10296166191941212575 0.21688865106647972625 -0.10325934296531706635 -0.23805777269297120902 0.22705752188801450742 -0.12823402382053572524 0.29432166043203361605 0.23748533573643940131 0.041627153248276163588 -0.063050935152215589752 0.31023687092378798846 0.07988729097972076254 -0.21613160417213950204 0.21310664746971694217 -0.27797022509538449331 0.031869094732170588635 0.21081583132588252449 0.2623479467511161678 0.00063851464123577299573 -0.23146613650478700674 0.20149886725058188675 -0.22977622474617173665 -0.026241034198490807011 -0.072963679268560871494 0.0086811412121517994578 0.082607984790691854626 0.080863758853855133291 -0.24479815831246173885 0.057466217590121743131 -0.06909013479149887782 0.01627873472448992595 0.072476556395217051065 -0.27974223320953744976 0.07903403688272298 0.1441410389175938056 -0.11861810638698710996 0.08879280117840492037 0.12869188298923714409 -0.071979476638423231516 0.25501101231942652214 -0.096814091375946431661 -0.021497975786602143561 -0.21869258509310202099 0.24609826545158386413 -0.14354408785998859499 0.028531273562641807501 -0.17522447329537485516 -0.27560398727441115518 -0.094721722897912322137 -0.11350573222087162462 -0.19814976661075156539 -0.20421168477626325255 0.11720845788459083314 -0.16074069047891997863 0.11997088438428943347 -0.14527118845276459913 0.15285416436513868388 0.12470062207575367819 0.086727812226006076313 0.17015780562306878632 0.067318477910387364282 -0.099179369269902326045 -0.063636811748054397664 -0.21355668747765377269 -0.044464637985873786685 -0.23010428816049388612 -0.025217129840008008917 0.083189177838064315429 0.19547845256074716791 0.12603762375100510673 0.076562461320983585256 -0.23925737943154326559 0.2341168478095561889 -0.18360305178739624865 0.22188026526299370333;-0.17967178738729266962 0.20589058916275965183 0.082404160695585454421 0.22865303245781976038 0.22296177125020688603 -0.13118991271403615539 -0.15304920955723425036 -0.20565168719512641471 -0.13401584743933434019 -0.051819164465615893955 -0.14200809713547321578 0.036388093764322483603 -0.15452589041787695434 0.18059984709277127068 -0.14536086770764558573 0.10853859784126411447 0.22365531533359161998 -0.11680007131990706448 0.22608273449350971274 0.2205099773330500279 0.22960828081067446993 -0.088085250122579519805 -0.2418348878441396177 0.060179102384397650805 -0.13826990027133267969 0.11595999701113889058 0.2056000095719258125 -0.062918705613999939552 0.061337186791263723085 0.0066366204249721115135 -0.14672368211721115161 -0.083021327340100870007 0.19497887547032488609 -0.075748867111055814827 -0.14525199113791614769 -0.10309229538482692079 0.20750759006372057613 0.021030279684099054127 -0.067807645542825867313 0.29112951345271975701 -0.070082497876177166085 -0.20373106104949020856 -0.26935753425725361687 0.082439454673784579031 -0.23026885366102201047 -0.1906967801961051423 -0.024821807620756197732 -0.16810709788263006326 -0.029198235451342556546 0.094745951406634915104 -0.16717121940628282273 -0.01506678851267303533 0.19529436977048034163 0.11262559826525822548 -0.18562607397667973963 -0.22935566703836648972 -0.26235028055438147643 0.11646596891225315107 0.21059452322357335996 0.23531772199208814134 -0.20093387574353530067 -0.19887594967384053524 0.059826269300582192445 0.11094857312801686966 -0.051423589414276299481 0.1004748623701357535 0.25778145623411435894 -0.11362645133315334156 -0.16068125041106331996 0.20841705925406184274 -0.047023459049520661968 -0.1174292368875037712 0.011357956937234204089 -0.2374086527419349002 -0.10750288117931403042 -0.1012347905757676747 0.083339520285582099901 0.1911384711185872276 0.039610786660698241168 -0.04671103515991947841 0.15814317721440954156 0.065507501456222971825 -0.15022990425456450581;-0.1736520074666370872 -0.16841149721227177682 -0.074247917769857646464 -0.21013857567893959311 -0.22542032408717430081 -0.24280559499103601673 0.24533584904571162366 0.039244884916025284116 -0.059590294957746023363 0.20379227107093364491 0.15952302190917422298 0.21071190897310115853 -0.050258830428298179038 -0.15030345012160978291 -0.070416212074563305778 -0.19545960414245661108 0.069073189737742846095 0.23844458855242553486 0.11387330737083575793 0.12319065575703912196 -0.24640478486317810014 -0.20191609450631789469 -0.2157230878183219458 0.26415589753226015324 0.015847086461233957089 0.1394660783401370785 0.23585336039212029258 0.21464989590438643408 -0.059969238849261613522 0.072477914696361181446 -0.13498688569614539223 -0.11107794053510863796 -0.10590433559749468095 -0.040520127153622173544 0.034679156562960770926 0.1194206888455811022 0.17888777395202409837 -0.20020140412656384221 -0.15580086726599373659 -0.15056647117742052999 -0.099990550168283329202 0.10063323623342863844 -0.10092447642866747559 0.11656804231985287701 -0.04679457793808721594 -0.091344981050634654896 0.13823947720101686931 -0.15416656013736776409 -0.16302473376236600866 -0.20267867354108809463 -0.25407025720163206595 0.16055009228023686685 -0.13452607054806720033 -0.17159382915712162454 0.17545680368595389931 0.042244367682953705423 -0.14414154334144843594 0.034344120224629785809 0.26509005155324738556 0.089075804569203026473 -0.055220146058786813426 -0.082747160190937932289 0.24245637868952235605 0.1213177978066263818 -0.17275719235478084745 -0.19651294894372958733 0.078351366124223470466 -4.9058267364807841399e-05 -0.11260190421617655154 0.15061458941738650741 -0.097216210653668935771 0.063740076715136317898 -0.038267149112892827334 0.24510762540741967697 0.24567523982050859521 -0.16672340712255517836 0.18001071000951163192 0.1201878713823624073 0.2068507141741379729 0.14472977867270273022 -0.24989523396263443877 -0.06924073745695169535 0.048092152838660175151;-0.10796646694036464431 -0.032604992625562455311 -0.1420845571871892643 0.13593648117631187966 -0.15431413111203354238 0.11460987472217810945 -0.15578577556578765417 -0.23016524437516799884 -0.1389950000860238899 -0.012367637034481369918 0.1828614687607735545 -0.23414951353663640554 -0.077764033415932923288 -0.18755661209913374043 0.03324341947750646814 -0.12951155371916983627 0.049643266372990380031 -0.10519708993075209402 0.10688591529748134312 -0.259660839833988355 0.22141977729807435504 -0.1228928657973911015 -0.09580639816999143854 -0.13587796482290231959 -0.012219856913450132668 -0.19710740596009251879 0.2361082646851274669 -0.068927220760681973122 -0.19247808501598184794 0.18302752193409863035 -0.30284243394341275879 0.027143713471497347978 0.20772179586195710366 -0.023449437658386550198 0.19863787079743416841 0.0014317308997564065151 0.45828794526747695937 -0.022089286238518100747 -0.031515008434844081486 -0.10422200049457125415 0.07381659447974327215 0.12598613725093135707 -0.17200622851217522991 -0.12110912711428317712 0.18665890746951091517 0.10793388793374546208 -0.36047376694432270439 -0.17458499917487382835 -0.15061752114469958985 -0.17692145725494626274 0.12942247638709872271 0.20881919407204041494 -0.15609528464953328908 0.17353478185884191332 0.057990791648823258875 -0.24915818099012426723 -0.13727324305820659545 -0.1088130669549042806 -0.27779802576285261839 0.086139789818836062785 -0.063709752156998283867 0.030432133742668003584 0.18064613516330019216 0.21020093062995806599 0.11085231139731613337 0.200738137301671421 0.14942336437161637952 -0.11229560394409200674 0.00131698495371476796 0.25672964077543075634 0.068761802382456840843 -0.086176654264043889286 0.13957994165056078484 -0.18035906864469630762 -0.14454053532673041826 -0.28948241517886513785 -0.33496243476996945265 0.078741833554690096597 0.018942511882288758096 -0.1867621141433732368 -0.22192098545113758679 0.022140025798558352066 -0.15233631665545421807;-0.084949917573385033687 0.25369672401340653822 -0.069289982567500726929 0.12406625956835524993 0.16744819284773068691 -0.22979219062849845501 -0.27123820981840263133 -0.16492877659772980925 -0.13295863896333734444 -0.1183316824665041761 -0.12439730123349031221 -0.17366048047008800226 -0.058573638133364851199 -0.097132419554671875495 -0.046017277238009066109 -0.16408661168517543749 0.010859364963026228029 -0.032409347446769973256 -0.12990711057922557647 -0.048585856566155431746 -0.16475019723804579241 0.012993607313457994704 0.025174570325905636092 -0.044950545945381281676 0.1067736166051141411 0.11388517661925734448 0.0095925488462379020216 0.14370008577991374987 0.059957722929091461506 -0.068619837934988409112 -0.0070038401512521391776 -0.071322264637278476318 0.038504151525734789385 -0.21971048398633163945 -0.009596695712453584548 0.03462478388631038545 -0.25210641168050168526 0.05171109960786602483 -0.10355227835349221921 0.13368682550500904371 -0.25493160576590867539 0.2970605121602671872 0.00038107048979566524385 0.032925044765528446722 0.14049779133335441039 0.170912585683913959 0.30376992199927910221 0.042279366185034555903 -0.083898625346383440271 0.36071408372768110073 0.30505019361468554973 0.0088168362513225007754 -0.08617108438228200662 -0.082247031408026763377 0.11909625585336613973 0.17556446240338699494 0.19859264260230058419 0.20312191414567407066 0.11386060239370095204 -0.21919687890947556208 0.1226702527699802675 -0.10500112256540097833 0.24056851365084841454 -0.16632651378251492313 0.11473696753705045492 0.23287122077199975956 0.090205201172273513643 -0.26438873509867832912 0.20471635752634168015 -0.1349315131574994886 0.095371974495421230067 0.24259234103864618648 -0.11366383384982180205 0.19760760412213057569 -0.17958636570751490558 -0.1310407834469280719 0.18121687762118751652 0.015229498832840601338 -0.15461023017833103177 0.18491731779860740015 -0.017675899129282975075 -0.159271938568803062 -0.26369693099688112925;-0.14466492307423259311 0.013085972938506740607 -0.071779975038841745127 0.034132471634003437588 0.067587132101603580869 0.13711341658287412582 0.059393270725832371382 0.14204241263903386039 -0.24863457402486854875 0.2311229094867683076 0.12739509193365389228 0.040600916688107190067 0.11198602978093880056 0.13855381619837001117 -0.10909791921757752697 0.081310278921660913976 -0.13096864960896859031 0.16187957546694448085 -0.20350434346371473748 0.21390496928344990279 0.16759060986888865696 0.23497374722458569396 -0.2274548284101050033 0.23792753448717096632 -0.080421071165450982998 0.24574862159371457793 0.012402064351059735939 0.21539168098008448782 -0.12464351860085963464 0.12100412036171347141 0.16636445024076376709 0.13736094807809190455 0.069875507317113977335 0.076339220703252649858 -0.094250281467747720754 0.2022311928298587691 -0.15101550694581833412 0.14752617577394386283 -0.15342006259286058989 0.052804295404429130167 -0.12271419154419246911 0.078169706452453510681 0.19703801111212854158 0.27076110978043976818 0.20973768624020566742 -0.049139832307644806808 -0.097337172436290947397 -0.15206403048272326695 -0.089249688547297201247 -0.11501264011430584189 -0.069633935631808890898 -0.16140916919528777718 -0.1400988677533350768 0.11978210665265899559 -0.22291841479783230939 0.24979617459827968551 0.0018889943983895853864 0.13756322590931585603 -0.049646796673970781943 -0.077758491427229237125 0.023442263670102790607 0.22073287351003753609 0.085606961908064299616 0.21784495303838979918 0.17564016039553492776 0.13353332972080209085 -0.10948286212338453893 -0.21492550357651180049 -0.22088981142859742679 -0.25520525333124727263 0.06960372101428353997 -0.12772135284454505522 -0.20532374276276005309 -0.076744554325244365711 -0.18798172631425263956 -0.25961899576924946098 0.1869063589492226396 -0.15548385001230430325 -0.21510770014356481172 0.18542456401682327893 -0.21712542370821760751 -0.086258610187194426078 -0.19396215016138695919;0.20058656789950479737 -0.029197014214452022413 -0.036913260449204995939 0.18988916028767535704 0.13271081220098843167 -0.081894934197448809865 0.27254758137496964965 -0.097333922271263972892 0.17162821099058167551 0.21093095654318305687 0.07395846000832559386 0.027128086035551973731 0.095576317024922863297 -0.038493592606361086428 -0.13291634543626337783 -0.097831472305767080977 -0.067619149099611294829 0.057213102700624442198 -0.15191405593826776133 -0.15929062741420085825 -0.17344134045924985976 0.19655664924375396141 -0.031646620229870844887 -0.18670751027345819373 0.1854135239813927416 -0.25331643204615600373 -0.24808751277734178431 0.16670553466518639452 0.036642197507772755749 0.010493261568813331761 0.097914674285746169935 0.33799661762508137475 -0.057413046705580818296 0.22922112947760273083 0.17588271912231201455 0.20617498124603983456 0.054640788847750483559 -0.12731284035160805868 -0.15973352284166103532 0.21902082713644044354 0.11256110205103134203 -0.17811416204115135264 -0.025867942450729968645 -0.15320381434734575699 0.18179733425164235072 -0.038114589930373157789 -0.073027767898767290133 0.049317055447096483367 -0.078667170613146500391 0.10522477671116908793 0.093643380490783564851 0.20402474871715411964 0.13957361798479669956 -0.29350004433291299044 -0.080155285766632625166 -0.078941382971989548789 -0.14582008208440394581 0.20064600437495666574 -0.13491315563601119498 -0.22188807095012957893 -0.26414415744176916734 -0.055539389737269302671 0.12359463837058780322 -0.32470250259103522472 0.1303994058238616971 -0.046799655355729795347 -0.12715919813349546574 0.17194290089787739317 -0.22183547570497311185 -0.26862051552811649913 0.090459532291366592793 -0.13178098988617473197 -0.22731398912857453398 0.014039500488687052526 -0.12710506421000913879 -0.32237739272509202682 0.25984233408933826714 -0.071878545605014373954 0.18260244850805551486 0.11474877990176296505 -0.2298860424495533239 0.19031364496473454628 0.015069660797086263659;0.044002936821729649042 0.13472169874271050505 -0.0060358282350192922483 0.26423081564559153245 -0.1314758556762289643 0.10174770762495759235 0.01648794433208458643 -0.066950179253947264546 -0.28192195132132141788 0.051463448661219511615 -0.18504195847206131309 0.27715370485399276612 0.0027561728082146569677 0.16156698661215476709 -0.2818549113358463365 -0.10603859649718221092 0.0019462653657275484805 -0.23324817767496702769 -0.28360031522673201376 -0.03845965014544580618 0.1269539330689880563 0.20591140217580508609 -0.075684692094004038521 -0.20936940123341504782 0.20060968507955442841 -0.20338472704452006945 -0.18107871618834026073 -0.21271500180974317606 0.11278553380159664354 -0.1516593871055082754 -0.21649557648225722928 -0.06413077621531711181 0.11088999958607513585 -0.10769730775636580933 0.18983941781006766214 0.028352633713151970118 0.05978722579720881225 -0.38377948892084667865 0.079983093554012188453 -0.1974992305124978198 0.11080325646810662565 -0.18045925938636980801 -0.21057755039414471909 -0.0072047630421579866161 0.065829065046712112452 -0.15140357307297269696 -0.33021339479901357095 -0.022720436936950284823 -0.36633005524470135805 0.015645135655042934075 -0.257602990985905278 0.14551410478660789516 -0.016506039964183191748 0.055004622645358727806 -0.026573726239153779016 0.0047517245056686238658 0.079466344579324166286 -0.091142230004305643809 -0.17771049435988381382 0.17360546801384843518 0.28224746108046516735 -0.13185930240988233408 0.24324428828239733069 -0.20358825212469908172 -0.013891960029276272451 0.27948985645739704564 -0.18977629224523540064 0.033083062346198878478 0.13476348679985927781 -0.043248838643777862134 0.21550564416266579371 -0.0038874624871546061 0.077583001014061375722 -0.076713826997727802004 -0.22912870343852323463 0.24327730932264687858 0.084611940134879840003 0.2080006767600386941 0.19384488070945768423 0.20815096074325675768 -0.12727292713106327926 0.13157048120181932815 -0.063019165950486719097;-0.1483323498184403455 -0.084828584241697049806 0.086193933542846878915 0.1493845681370563061 0.13619033624243681579 -0.0064275291740381740313 -0.11962764353112052829 -0.09480740799988146561 0.21210093738808311059 -0.12072823921823133686 0.19256038586517104649 -0.11921203642574457193 0.0053273834298662820982 -0.10854926563944074236 -0.26755603464285615534 0.14897523085272432186 0.10044229103123251956 0.12220925577735307355 -0.075394913101980029491 0.059120346039363481927 0.022862546566286515159 -0.012494991231118648956 -0.066883873027078988294 -0.17807530663733994736 0.21320664988182069788 0.014168476686603308223 -0.19062742916991476383 0.0022808740677913042633 -0.31614753662404349033 -0.13253929782011691918 0.0083442157895521566063 -0.22902284306696626959 0.094024192618891277995 0.14681839987755554433 -0.25056853936822837126 0.15282275860052974004 -0.077561234866533337873 -0.027110777418381623582 -0.31214926759599687101 -0.052978477910726809452 0.13874508924556624989 0.066734752381099285423 0.075322989106508711488 0.15085258630299194782 -0.14977952876758468537 -0.26802529610385339431 -0.34967788082162942764 -0.41959316214018710367 -0.24299929133181791263 -0.26204766659481792956 -0.1552208741210095444 0.17838673514732963921 -0.11487610373462966984 0.16043971224217387639 0.2134131088463395165 -0.18285291141182627439 -0.043373376907289269699 0.098699988644098027302 0.16430574806509007368 0.11407025551226959714 -0.18421497876373818525 -0.15508586611652150355 0.18440353404780901458 0.03556832562915563517 0.082985784571611057037 -0.050992033309396209151 0.18801382427037816036 0.26251525828848149002 -0.17432156674500004501 0.066523273038013003289 -0.19201661449495735501 -0.27050764888944922593 -0.28591485855509285452 0.1586813818581714608 -0.032653621769774036909 -0.27373908220146625503 -0.16063316776868874491 0.16522232136903472477 0.019138230232228794353 -0.082746479072818152067 -0.10388147083340959487 -0.20324681423685522774 -0.065739488511166094264;0.16232195356939002617 0.12123759422538306352 0.18711992143992256521 -0.26768978925822634052 -0.034033196584554704922 0.020912161387846101013 -0.04600176672121515653 0.047111110699403949131 0.2274268895973366178 0.27000529624928820693 -0.11568201418194705432 0.22929965666051757567 -0.074077580732419032183 0.18389449642590385836 0.28228534983124081714 0.0096125077607694467408 0.13655866987778444988 -0.21888909145165300063 0.19891832738242753997 -0.21025860041845512161 0.2201552525804235938 0.23033947422616057876 0.035356789774512099866 0.02470907237660254635 -0.027330414905880961313 0.073418853867705927141 -0.052286276797034944575 0.17774095762491273764 0.19373130729026472041 -0.11122604271897321149 -0.22128006989795726001 -0.32190501673399773974 -0.29050518944148823186 0.047189886588005554302 0.053245058563268186924 -0.20014872015561555041 0.19894423869224625578 0.18027421857467723632 0.03833799346315906742 -0.24349024673543351316 0.085723207374414092663 0.061215109196044524553 0.12876763930704743233 -0.2185517792939131454 0.23281476854050223158 -0.18867854252514901225 0.037924540364055028818 -0.19590039551937560303 -0.28032341517393671859 -0.31012459857776625283 -0.050750317793130453325 0.088595986079703051286 -0.03149934548672425616 -0.12993867310886700328 -0.050941857816569735551 -0.05662642350730342361 0.055553667715217240619 -0.052341792731338945832 0.18067730920713520604 -0.20839274512841962639 -0.14583536390561760432 -0.018368111506402919064 0.27920464171933723208 -0.13230662586917796286 -0.1694852465028525712 0.24677283409499081723 0.27254387548313635525 -0.093279816568783174846 -0.084135720245368569858 0.032094945346565664779 0.1677494650928559039 -0.26545167725292068139 -0.051027987479935560389 -0.1903669359612318035 0.19895276634732395049 0.22633843779059900636 0.067683427235456061766 -0.20316812671469855478 -0.055071905910150070751 0.037294666944476632942 0.012069468818653771372 -0.0053558716024541611067 -0.019006452861413114519];

% Layer 2
b2 = 0.20613265036891237347;
LW2_1 = [0.67477392897612586964 0.45449291185207296717 -0.058783491696107054159 -1.1663164677606163711 0.69884690917059044679 -0.24445348239367092891 1.4361758144133969228 -0.94159418613507717133 -1.2830685255032645564 -0.50095980210996360338];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
